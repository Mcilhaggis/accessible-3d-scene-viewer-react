"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),r=e(t),n=require("@react-three/fiber"),o=e(require("zustand")),i=e(require("react-dom/client")),s=require("three");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(r=i[n])>=0||(o[r]=e[r]);return o}var u=o((function(e){return{message:"",a11yScreenReader:function(t){e((function(){return{message:t}}))}}})),d={opacity:0,borderRadius:"50%",width:"50px",height:"50px",overflow:"hidden",transform:"translateX(-50%) translateY(-50%)",display:"inline-block",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",margin:0},l=r.createContext(t.createRef());l.displayName="A11ySectionContext";var f=new s.Vector3,p=new s.Vector3,m=new s.Vector3;function v(e,t,r){var n=f.setFromMatrixPosition(e.matrixWorld);n.project(t);var o=r.width/2,i=r.height/2;return[n.x*o+o,-n.y*i+i]}var h=t.forwardRef((function(e,r){var o,u=e.children,d=e.eps,l=void 0===d?.001:d,h=e.style,y=e.className,g=e.portal,b=e.zIndexRange,x=void 0===b?[16777271,0]:b,E=c(e,["children","eps","style","className","portal","zIndexRange"]),w=n.useThree((function(e){return e.gl})),k=n.useThree((function(e){return e.camera})),M=n.useThree((function(e){return e.scene})),P=n.useThree((function(e){return e.size})),S=t.useState((function(){return document.createElement("div")}))[0],R=t.useMemo((function(){return i.createRoot(S)}),[S]),O=t.useRef(null),C=t.useRef(0),A=t.useRef([0,0]),j=null!=(o=null==g?void 0:g.current)?o:w.domElement.parentNode;t.useEffect((function(){if(O.current){M.updateMatrixWorld();var e=v(O.current,k,P);return S.style.cssText="position:absolute;top:0;left:0;transform:translate3d("+e[0]+"px,"+e[1]+"px,0);transform-origin:0 0;",j&&j.appendChild(S),function(){j&&j.removeChild(S),R.unmount()}}}),[j]);var T=t.useMemo((function(){return a({position:"absolute",transform:"none"},h)}),[h,P]);return t.useLayoutEffect((function(){R.render(t.createElement("div",{ref:r,style:T,className:y,children:u}))})),n.useFrame((function(){if(O.current){k.updateMatrixWorld();var e=v(O.current,k,P);(Math.abs(C.current-k.zoom)>l||Math.abs(A.current[0]-e[0])>l||Math.abs(A.current[1]-e[1])>l)&&(S.style.display=function(e,t){var r=f.setFromMatrixPosition(e.matrixWorld),n=p.setFromMatrixPosition(t.matrixWorld),o=r.sub(n),i=t.getWorldDirection(m);return o.angleTo(i)>Math.PI/2}(O.current,k)?"none":"block",S.style.zIndex=""+function(e,t,r){if(t instanceof s.PerspectiveCamera||t instanceof s.OrthographicCamera){var n=f.setFromMatrixPosition(e.matrixWorld),o=p.setFromMatrixPosition(t.matrixWorld),i=n.distanceTo(o),a=(r[1]-r[0])/(t.far-t.near);return Math.round(a*i+(r[1]-a*t.far))}}(O.current,k,x),S.style.transform="translate3d("+e[0]+"px,"+e[1]+"px,0) scale(1)",A.current=e,C.current=k.zoom)}})),t.createElement("group",Object.assign({},E,{ref:O}))})),y=r.createContext({focus:!1,hover:!1,pressed:!1});y.displayName="A11yContext";var g=r.createContext({a11yPrefersState:{prefersReducedMotion:!1,prefersDarkScheme:!1},setA11yPrefersState:function(e){}});g.displayName="A11yUserPreferencesContext";var b=function(){return t.useContext(g)},x={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",whiteSpace:"nowrap",padding:0,width:"1px",position:"absolute"};exports.A11y=function(e){var o=e.children,i=e.description,s=e.activationMsg,a=e.deactivationMsg,f=e.tabIndex,p=e.href,m=e.role,v=e.showAltText,g=void 0!==v&&v,b=e.actionCall,x=e.focusCall,E=e.disabled,w=e.debug,k=void 0!==w&&w,M=e.a11yElStyle,P=e.startPressed,S=void 0!==P&&P,R=e.tag,O=void 0===R?"p":R,C=e.hidden,A=void 0!==C&&C,j=e.dragThreshold,T=c(e,["children","description","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","tag","hidden","dragThreshold"]),D=Object.assign({},d,{opacity:k?1:0},M),L=t.useState({hovered:!1,focused:!1,pressed:S||!1}),F=L[0],I=L[1],W=u((function(e){return e.a11yScreenReader})),N=t.useRef(!1),q=t.useRef(!1),z=n.useThree((function(e){return e.gl.domElement})),B=t.useRef(!0);t.useEffect((function(){return function(){z.style.cursor="default",B.current=!1}}),[]),r.Children.only(o);var U=function(e){e.eventObject?q.current=!0:N.current=!0,(N.current||q.current)&&("content"===m||"image"===m||E||(z.style.cursor="pointer"),I({hovered:!0,focused:F.focused,pressed:F.pressed}))},H=function(e){e.eventObject?q.current=!1:N.current=!1,N.current||q.current||B.current&&(z.style.cursor="default",I({hovered:!1,focused:F.focused,pressed:F.pressed}))};function V(){W(""),window.setTimeout((function(){"string"==typeof s&&W(s)}),100),"function"==typeof b&&b()}function _(){F.pressed?"string"==typeof a&&W(a):"string"==typeof s&&W(s),I({hovered:F.hovered,focused:F.focused,pressed:!F.pressed}),"function"==typeof b&&b()}var X=r.useMemo((function(){if("button"===m||"togglebutton"===m)return r.createElement("button",Object.assign({"r3f-a11y":"true"},E?{disabled:!0}:null,"togglebutton"===m?{"aria-pressed":F.pressed?"true":"false",tabIndex:f||0,style:Object.assign(D,E?{cursor:"default"}:{cursor:"pointer"},A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:U,onPointerOut:H,onClick:function(e){e.stopPropagation(),E||_()},onFocus:function(){"function"==typeof x&&x(),I({hovered:F.hovered,focused:!0,pressed:F.pressed})},onBlur:function(){I({hovered:F.hovered,focused:!1,pressed:F.pressed})}}:{tabIndex:f||0,style:Object.assign(D,E?{cursor:"default"}:{cursor:"pointer"},A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:U,onPointerOut:H,onClick:function(e){e.stopPropagation(),E||V()},onFocus:function(){"function"==typeof x&&x(),I({hovered:F.hovered,focused:!0,pressed:F.pressed})},onBlur:function(){I({hovered:F.hovered,focused:!1,pressed:F.pressed})}}),i);if("link"===m)return r.createElement("a",{"r3f-a11y":"true",style:Object.assign(D,A?{visibility:"hidden"}:{visibility:"visible"}),href:p,onPointerOver:U,onPointerOut:H,onClick:function(e){e.stopPropagation(),e.preventDefault(),"function"==typeof b&&b()},onFocus:function(){"function"==typeof x&&x(),I({hovered:F.hovered,focused:!0,pressed:F.pressed})},onBlur:function(){I({hovered:F.hovered,focused:!1,pressed:F.pressed})}},i);var e=f?{tabIndex:f}:null;return"image"===m?r.createElement("img",Object.assign({"r3f-a11y":"true",src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E",alt:i},e,{style:Object.assign(D,A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:U,onPointerOut:H,onBlur:function(){I({hovered:F.hovered,focused:!1,pressed:F.pressed})},onFocus:function(){"function"==typeof x&&x(),I({hovered:F.hovered,focused:!0,pressed:F.pressed})}})):r.createElement(O,Object.assign({"r3f-a11y":"true"},e,{style:Object.assign(D,A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:U,onPointerOut:H,onBlur:function(){I({hovered:F.hovered,focused:!1,pressed:F.pressed})},onFocus:function(){"function"==typeof x&&x(),I({hovered:F.hovered,focused:!0,pressed:F.pressed})}}),i)}),[i,F,A,f,p,E,S,O,b,x]),Y=null;g&&F.hovered&&(Y=r.createElement("div",{"aria-hidden":!0,style:{width:"auto",maxWidth:"300px",display:"block",position:"absolute",top:"0px",left:"0px",transform:"translate(-50%,-50%)",background:"white",borderRadius:"4px",padding:"4px"}},r.createElement("p",{"aria-hidden":!0,style:{margin:"0px"}},i)));var Z=t.useContext(l),G={};return Z.current instanceof HTMLElement&&(G={portal:Z}),r.createElement(y.Provider,{value:{hover:F.hovered,focus:F.focused,pressed:F.pressed}},r.createElement("group",Object.assign({},T,{onClick:function(e){e.stopPropagation(),E||j&&e.delta>j||("button"===m?V():"togglebutton"===m?_():"function"==typeof b&&b())},onPointerOver:U,onPointerOut:H}),o,r.createElement(h,Object.assign({style:{width:"0px"},position:o.props.position?o.props.position:0},G),Y,X)))},exports.A11yAnnouncer=function(){var e=u((function(e){return e.message}));return t.useEffect((function(){var e=function(e){var t;null!=(t=window.document.activeElement)&&t.getAttribute("r3f-a11y")&&0!==e.detail&&window.document.activeElement instanceof HTMLElement&&window.document.activeElement.blur()};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}})),r.createElement("div",{style:x,"aria-atomic":"true","aria-live":"polite"},e)},exports.A11yDebuger=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var n=t.useState((function(){return document.createElement("div")}))[0],o=r.useMemo((function(){return i.createRoot(n)}),[n]),s=t.useState({}),a=s[0],c=s[1],u=t.useState({prefersDarkScheme:!1,prefersReducedMotion:!1}),d=u[0],l=u[1],f=b(),p=f.a11yPrefersState,m=f.setA11yPrefersState,v=t.useRef(null);t.useEffect((function(){n.style.cssText="position:fixed;top:0;left:0;",n.setAttribute("aria-hidden","true"),document.body.appendChild(n),l({prefersDarkScheme:p.prefersDarkScheme,prefersReducedMotion:p.prefersReducedMotion});var e=function(){var e;console.log("focused: ",document.activeElement);var t=null==(e=document.activeElement)?void 0:e.getAttribute("r3f-a11y-debug-id");if(t){document.querySelectorAll("[r3fa11ydebugidref]").forEach((function(e){e.style.color=null}));var r=document.querySelector('[r3fa11ydebugidref="'+t+'"]');r&&(r.style.color="red")}},t=i.createRoot(v.current);console.log("enregistre ev"),document.addEventListener("focus",e,!0);var o=window.setInterval((function(){var e=0,n=[];document.querySelectorAll("[r3f-a11y]").forEach((function(t){t.setAttribute("r3f-a11y-debug-id",""+e),n.push(r.createElement("li",{key:e,r3fa11ydebugidref:e},t.tagName,r.createElement("button",{tabIndex:-1,onClick:function(){console.log(t);var e=t.getBoundingClientRect();c({width:e.width,height:e.height,top:e.top,left:e.left})}},"Show"))),e++})),t.render(r.createElement(r.Fragment,null,n))}),2e3);return function(){clearInterval(o),t.unmount(),console.log("remove ev"),document.removeEventListener("focus",e,!0)}}),[p]);var h=function(e){m({prefersDarkScheme:"prefersDarkScheme"===e.target.name?e.target.checked:d.prefersDarkScheme,prefersReducedMotion:"prefersReducedMotion"===e.target.name?e.target.checked:d.prefersReducedMotion})};return t.useLayoutEffect((function(){o.render(r.createElement(r.Fragment,null,r.createElement("label",null,"Prefer dark mode",r.createElement("input",{type:"checkbox",name:"prefersDarkScheme",checked:d.prefersDarkScheme,onChange:h})),r.createElement("label",null,"Prefer reduced motion",r.createElement("input",{type:"checkbox",name:"prefersReducedMotion",checked:d.prefersReducedMotion,onChange:h})),r.createElement("h3",null,"R3F Dom order"),r.createElement("ul",{ref:v}),r.createElement("div",{style:Object.assign({position:"absolute",border:"1px solid white",borderRadius:"50%",background:"linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))",pointerEvents:"none",transition:"all 200ms ease"},a)})))})),r.createElement(r.Fragment,null)},exports.A11ySection=function(e){var o=e.children,i=e.label,s=e.description,a=t.useRef(null),c=t.useRef(null),u=n.useThree((function(e){return e.gl})),f=r.useState((function(){return document.createElement("section")}))[0],p=u.domElement.parentNode;return t.useEffect((function(){var e;if(i&&f.setAttribute("aria-label",i),f.setAttribute("r3f-a11y","true"),f.setAttribute("style",(e=d,Object.keys(e).reduce((function(t,r){return t+r.split(/(?=[A-Z])/).join("-").toLowerCase()+":"+e[r]+";"}),""))),s)if(null===c.current){var t=document.createElement("p");t.innerHTML=s,t.style.cssText="border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;",f.prepend(t),c.current=t}else c.current.innerHTML=s;return function(){p&&p.removeChild(f)}}),[s,i]),null===a.current&&(p&&p.appendChild(f),a.current=f),r.createElement(r.Fragment,null,r.createElement(l.Provider,{value:a},o))},exports.A11yUserPreferences=function(e){var n=e.children,o=t.useState({prefersReducedMotion:!1,prefersDarkScheme:!1}),i=o[0],s=o[1];return t.useEffect((function(){var e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=window.matchMedia("(prefers-color-scheme: dark)");s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches});var r=function(e){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})},n=function(t){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})};return"function"==typeof e.addEventListener&&e.addEventListener("change",r),"function"==typeof t.addEventListener&&t.addEventListener("change",n),function(){"function"==typeof e.removeEventListener&&e.removeEventListener("change",r),"function"==typeof t.removeEventListener&&t.removeEventListener("change",n)}}),[]),r.createElement(g.Provider,{value:{a11yPrefersState:{prefersReducedMotion:i.prefersReducedMotion,prefersDarkScheme:i.prefersDarkScheme},setA11yPrefersState:s}},n)},exports.A11yUserPreferencesContext=g,exports.useA11y=function(){return t.useContext(y)},exports.useUserPreferences=b;
//# sourceMappingURL=a11y.cjs.production.min.js.map
